<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Animalhotels Collectors</title>
<style>
  :root{
    --bg:#0f172a;          /* slate-900 */
    --panel:#111827cc;     /* semi slate */
    --text:#e5e7eb;        /* gray-200 */
    --accent:#22d3ee;      /* cyan-400 */
    --good:#10b981;        /* emerald-500 */
    --bad:#ef4444;         /* red-500 */
    --gold:#f59e0b;        /* amber-500 */
  }
  *{box-sizing:border-box; -webkit-tap-highlight-color: transparent;}
  html,body{margin:0;height:100%;background:radial-gradient(1200px 600px at 50% 10%, #111827, #0b1227 60%, #070d1d 100%);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;}
  #wrap{display:flex;flex-direction:column;min-height:100%;}
  header{
    display:flex;align-items:center;justify-content:space-between;gap:.75rem;
    padding:10px 16px;border-bottom:1px solid #1f2937;background:#0b1227aa;backdrop-filter: blur(4px);position:sticky;top:0;z-index:5;
  }
  .brand{display:flex;align-items:center;gap:.6rem;font-weight:700;letter-spacing:.3px}
  .diamond{
    width:22px;height:22px;border:2px solid var(--accent);transform:rotate(45deg);
    border-radius:3px;box-shadow:0 0 8px #22d3ee66 inset, 0 0 8px #22d3ee55;
  }
  .pill{display:inline-flex;gap:.5rem;align-items:center;padding:6px 10px;border:1px solid #1f2937;border-radius:999px;background:#0a1328; font-size:13px}
  .good{color:var(--good)} .bad{color:var(--bad)} .gold{color:var(--gold)}
  #hud{display:flex;gap:.5rem;flex-wrap:wrap}
  #game{
    flex:1;display:flex;align-items:center;justify-content:center;position:relative;
  }
  canvas{display:block;width:100%;height:100%;}
  .overlay{
    position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;
    padding:24px;text-align:center;background:linear-gradient(180deg,#0b1227ee,#0b1227cc);gap:18px;z-index:3;
  }
  .dialog{
    width:min(560px,92vw);padding:18px 16px;border:1px solid #1f2937;border-radius:16px;background:var(--panel);
    box-shadow: 0 10px 30px #0006;
  }
  h1{font-size:22px;margin:0 0 8px}
  p{margin:6px 0 0;line-height:1.45;color:#cbd5e1}
  .btnrow{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;justify-content:center}
  button{
    appearance:none;border:none;border-radius:12px;padding:12px 16px;font-weight:700;
    background:linear-gradient(180deg,#1c2d55,#122348);color:#e5e7eb;box-shadow:0 4px 12px #0007;cursor:pointer;
  }
  button.primary{background:linear-gradient(180deg,#22d3ee,#1991b7);color:#06202a}
  button:active{transform:translateY(1px)}
  input[type="text"]{
    width:100%;padding:12px 14px;border-radius:12px;border:1px solid #20314e;background:#0a1328;color:#e5e7eb;
    outline:none;
  }
  .kbd{padding:2px 8px;border-radius:6px;border:1px solid #24324a;background:#0a1328;font-size:12px;color:#cbd5e1}
  .list{margin:10px 0 0;padding:0;list-style:none;display:grid;gap:6px}
  .list li{display:flex;justify-content:space-between;padding:8px 10px;background:#0a1328;border-radius:10px;border:1px solid #1f2937}
  footer{padding:10px 14px;text-align:center;color:#9ca3af;font-size:12px}
  .tiny{font-size:12px;color:#9ca3af}
</style>
</head>
<body>
<div id="wrap">
  <header>
    <div class="brand"><div class="diamond" aria-hidden="true"></div><div>Animal<strong>hotels</strong> Collectors</div></div>
    <div id="hud">
      <div class="pill"><span>Level</span> <strong id="level" class="gold">1</strong></div>
      <div class="pill"><span>Score</span> <strong id="score">0</strong></div>
      <div class="pill"><span>Lives</span> <strong id="lives" class="good">â¤â¤â¤</strong></div>
      <div class="pill"><span>Best</span> <strong id="best">0</strong></div>
    </div>
  </header>

  <div id="game">
    <canvas id="c"></canvas>

    <!-- Start / How-to overlay -->
    <div id="start" class="overlay" role="dialog" aria-modal="true">
      <div class="dialog">
        <h1>Recruit smiling sitters and happy pets!</h1>
        <p>Tap (or click) the <span class="good">ğŸ™‚ smiling sitters</span> and <span class="good">happy pets</span> ğŸ¶ğŸ˜ºğŸ°ğŸ¹ğŸ¦ğŸ¢ as they float by.</p>
        <p>Donâ€™t tap <span class="bad">grumpy sitters</span> ğŸ™ or <span class="bad">sad pets</span> ğŸ˜¿ â€” that costs a life.</p>
        <p>Collect fast streaks to earn bonus points and level up. Each level speeds up and spawns more.</p>
        <div class="btnrow">
          <button class="primary" id="playBtn">Play</button>
          <button id="howBtn">How to play</button>
          <button id="boardBtn">Leaderboard</button>
        </div>
      </div>
    </div>

    <!-- How-to -->
    <div id="how" class="overlay" hidden>
      <div class="dialog">
        <h1>How to play</h1>
        <p>Tap directly on good targets to collect them.</p>
        <p class="tiny">Good: ğŸ™‚ ğŸ¶ ğŸ˜º ğŸ° ğŸ¹ ğŸ¦ ğŸ¢<br/>Bad: ğŸ™ ğŸ˜¿ ğŸ˜¾ ğŸ˜¡ ğŸ’¢</p>
        <ul class="list">
          <li><span>Hit a good target</span><span class="good">+10 pts</span></li>
          <li><span>Quick streak (under 500ms)</span><span class="gold">+5 bonus</span></li>
          <li><span>Tap a bad target</span><span class="bad">-1 life</span></li>
          <li><span>Miss a good target off-screen</span><span class="bad">-1 life</span></li>
        </ul>
        <p>Levels increase every 100 points. Reach higher levels to prove your Animalhotels mastery.</p>
        <div class="btnrow">
          <button class="primary" id="playFromHow">Start</button>
          <button id="backFromHow">Back</button>
        </div>
      </div>
    </div>

    <!-- Game Over / Leaderboard -->
    <div id="over" class="overlay" hidden>
      <div class="dialog">
        <h1>Game Over</h1>
        <p>Your score: <strong id="finalScore">0</strong></p>
        <div id="nameRow">
          <p>Save to leaderboard:</p>
          <input id="playerName" maxlength="12" placeholder="Your name or initials" />
          <div class="btnrow">
            <button class="primary" id="saveBtn">Save</button>
          </div>
        </div>
        <h1 style="margin-top:14px">Leaderboard</h1>
        <ul id="board" class="list" aria-live="polite"></ul>
        <div class="btnrow">
          <button class="primary" id="againBtn">Play again</button>
          <button id="menuBtn">Main menu</button>
          <button id="clearBtn" title="Clear local leaderboard">Clear board</button>
        </div>
      </div>
    </div>
  </div>

  <footer>Made for Animalhotels â€” collect the smiles, grow the community.</footer>
</div>

<script>
(() => {
  // ----- Canvas & layout scaling for crisp emoji -----
  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d');

  function fitCanvas(){
    const dpr = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
    const w = canvas.clientWidth = canvas.parentElement.clientWidth;
    const h = canvas.clientHeight = Math.max(480, window.innerHeight - document.querySelector('header').offsetHeight - 20);
    canvas.width = Math.floor(w * dpr);
    canvas.height = Math.floor(h * dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);
  }
  window.addEventListener('resize', fitCanvas, {passive:true});
  fitCanvas();

  // ----- Game state -----
  const HUD = {
    score: document.getElementById('score'),
    level: document.getElementById('level'),
    lives: document.getElementById('lives'),
    best: document.getElementById('best'),
  };
  const UI = {
    start: document.getElementById('start'),
    how: document.getElementById('how'),
    over: document.getElementById('over'),
    boardList: document.getElementById('board'),
    finalScore: document.getElementById('finalScore'),
    nameRow: document.getElementById('nameRow'),
    nameInput: document.getElementById('playerName'),
  };
  const BTN = {
    play: document.getElementById('playBtn'),
    how: document.getElementById('howBtn'),
    board: document.getElementById('boardBtn'),
    playFromHow: document.getElementById('playFromHow'),
    backFromHow: document.getElementById('backFromHow'),
    save: document.getElementById('saveBtn'),
    again: document.getElementById('againBtn'),
    menu: document.getElementById('menuBtn'),
    clear: document.getElementById('clearBtn'),
  };

  const GOOD_PETS = ['ğŸ¶','ğŸ˜º','ğŸ°','ğŸ¹','ğŸ¦','ğŸ¢'];
  const GOOD_SITTER = 'ğŸ™‚';
  const BAD_THINGS = ['ğŸ™','ğŸ˜¿','ğŸ˜¾','ğŸ˜¡','ğŸ’¢']; // decoys

  let running = false;
  let score = 0;
  let level = 1;
  let lives = 3;
  let lastCollectTime = 0;
  let spawnTimer = 0;
  let spawnEvery = 900; // ms, reduced by level
  let things = [];

  // Leaderboard
  const LB_KEY = 'ahCollectorsLeaderboard';
  function getLB(){
    try{ return JSON.parse(localStorage.getItem(LB_KEY)) || []; }catch(e){ return []; }
  }
  function setLB(arr){
    localStorage.setItem(LB_KEY, JSON.stringify(arr.slice(0,10)));
  }
  function renderLB(){
    const lb = getLB();
    UI.boardList.innerHTML = lb.length ? '' : '<li><span>No records yet</span><span>â€”</span></li>';
    lb.forEach((row, i)=>{
      const li = document.createElement('li');
      li.innerHTML = `<span>${i+1}. ${row.name}</span><span>${row.score}</span>`;
      UI.boardList.appendChild(li);
    });
  }
  HUD.best.textContent = (getLB()[0]?.score)||0;

  // ----- Entities -----
  function rand(min,max){ return Math.random()*(max-min)+min; }
  function pick(arr){ return arr[(Math.random()*arr.length)|0]; }

  function spawn(){
    // decide good or bad with bias towards good targets
    const isGood = Math.random() < 0.67;
    let emoji, type;
    if(isGood){
      if(Math.random() < 0.35){
        emoji = GOOD_SITTER;
        type = 'good-sitter';
      } else {
        emoji = pick(GOOD_PETS);
        type = 'good-pet';
      }
    } else {
      emoji = pick(BAD_THINGS);
      type = 'bad';
    }
    const size = rand(28, 40); // font size in px
    const x = rand(size*1.2, (canvas.clientWidth - size*1.2));
    const y = canvas.clientHeight + size; // start just below
    const vy = -rand(40 + level*6, 80 + level*10) / 60; // px/frame upwards
    const sway = rand(0.4, 1.2) * (Math.random()<.5? -1:1); // horizontal drift
    things.push({emoji, type, x, y, vy, sway, size, ttl: 12000});
  }

  // ----- Game loop -----
  let last = 0;
  function loop(ts){
    if(!running) return;
    if(!last) last = ts;
    const dt = Math.min(50, ts - last); // ms
    last = ts;

    // spawn pacing
    spawnTimer += dt;
    const pace = Math.max(280, spawnEvery - level*50);
    while(spawnTimer > pace){
      spawn();
      spawnTimer -= pace;
    }

    // update
    ctx.clearRect(0,0,canvas.clientWidth, canvas.clientHeight);
    things.forEach(t=>{
      t.y += t.vy * dt;
      t.x += Math.sin((t.y+t.size)*0.02)*t.sway;
      t.ttl -= dt;

      // draw
      ctx.font = `bold ${t.size}px system-ui, Apple Color Emoji, Segoe UI Emoji`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.shadowColor = t.type==='bad' ? 'rgba(239,68,68,.6)' : 'rgba(34,211,238,.6)';
      ctx.shadowBlur = 8;
      ctx.fillText(t.emoji, t.x, t.y);
      ctx.shadowBlur = 0;
    });

    // cull & life loss for missed good items
    for(let i=things.length-1;i>=0;i--){
      const t = things[i];
      if(t.y < -50 || t.ttl<=0){
        if(t.type!=='bad'){ // missed a good target
          loseLife();
        }
        things.splice(i,1);
      }
    }
    requestAnimationFrame(loop);
  }

  function loseLife(){
    lives--;
    HUD.lives.textContent = 'â¤â¤â¤'.slice(0,lives).padEnd(3,'Â·');
    HUD.lives.style.color = lives===1 ? 'var(--bad)' : 'var(--good)';
    if(lives<=0){ endGame(); }
  }

  function addScore(base){
    score += base;
    const newLevel = Math.floor(score/100)+1;
    if(newLevel!==level){
      level = newLevel;
      HUD.level.textContent = level;
      // tiny level-up flash
      flashText(`Level ${level}!`, '#22d3ee');
    }
    HUD.score.textContent = score;
  }

  function flashText(text, color){
    const w = canvas.clientWidth, h = canvas.clientHeight;
    ctx.save();
    ctx.globalAlpha = 0.9;
    ctx.fillStyle = color||'#fff';
    ctx.font = `900 36px system-ui, sans-serif`;
    ctx.textAlign = 'center';
    ctx.fillText(text, w/2, h*0.22);
    ctx.restore();
  }

  // ----- Input (touch/click) -----
  function getLocalXY(ev){
    const rect = canvas.getBoundingClientRect();
    let x,y;
    if(ev.touches && ev.touches[0]){
      x = ev.touches[0].clientX - rect.left;
      y = ev.touches[0].clientY - rect.top;
    } else {
      x = ev.clientX - rect.left;
      y = ev.clientY - rect.top;
    }
    return {x,y};
  }

  function handleTap(ev){
    if(!running) return;
    const {x,y} = getLocalXY(ev);
    // find top-most item under tap
    for(let i=things.length-1;i>=0;i--){
      const t = things[i];
      const r = t.size*0.6; // hit radius
      const dx = x - t.x;
      const dy = y - t.y;
      if(dx*dx + dy*dy <= r*r){
        // handle hit
        if(t.type==='bad'){
          flashText('Oops!', '#ef4444');
          loseLife();
        } else {
          const now = performance.now();
          const quick = (now - lastCollectTime) < 500;
          lastCollectTime = now;
          const bonus = quick ? 5 : 0;
          addScore(10 + bonus);
          if(bonus){ flashText('+15 (streak!)', '#f59e0b'); }
        }
        things.splice(i,1);
        break;
      }
    }
  }
  canvas.addEventListener('click', handleTap);
  canvas.addEventListener('touchstart', (e)=>{ handleTap(e); }, {passive:true});

  // ----- Game control -----
  function reset(){
    score = 0; level = 1; lives = 3; lastCollectTime = 0; spawnTimer = 0;
    things = [];
    HUD.score.textContent = '0';
    HUD.level.textContent = '1';
    HUD.lives.textContent = 'â¤â¤â¤';
    HUD.lives.style.color = 'var(--good)';
  }

  function startGame(){
    UI.start.hidden = true;
    UI.how.hidden = true;
    UI.over.hidden = true;
    reset();
    running = true;
    last = 0;
    requestAnimationFrame(loop);
  }

  function endGame(){
    running = false;
    UI.finalScore.textContent = score;
    UI.over.hidden = false;
    UI.nameRow.style.display = 'block';
    UI.nameInput.value = '';
    renderLB();
    // update best
    const best = Math.max(Number(HUD.best.textContent||0), score);
    HUD.best.textContent = best;
  }

  // ----- Buttons -----
  BTN.play.addEventListener('click', startGame);
  BTN.how.addEventListener('click', ()=>{ UI.start.hidden = true; UI.how.hidden = false; });
  BTN.board.addEventListener('click', ()=>{
    UI.start.hidden = true; UI.over.hidden = false; UI.nameRow.style.display='none'; renderLB();
  });
  BTN.playFromHow.addEventListener('click', startGame);
  BTN.backFromHow.addEventListener('click', ()=>{ UI.how.hidden = true; UI.start.hidden = false; });

  BTN.save.addEventListener('click', ()=>{
    const name = UI.nameInput.value.trim() || 'Guest';
    const lb = getLB();
    lb.push({name, score});
    lb.sort((a,b)=> b.score - a.score);
    setLB(lb);
    UI.nameRow.style.display = 'none';
    renderLB();
  });
  BTN.again.addEventListener('click', startGame);
  BTN.menu.addEventListener('click', ()=>{
    UI.over.hidden = true; UI.start.hidden = false;
  });
  BTN.clear.addEventListener('click', ()=>{
    localStorage.removeItem(LB_KEY);
    renderLB();
    HUD.best.textContent = 0;
  });

  // Accessibility: keyboard support (desktop)
  document.addEventListener('keydown', (e)=>{
    if(e.key===' '||e.key==='Enter'){
      if(UI.start.hidden===false){ startGame(); }
    }
  });
})();
</script>
</body>
</html>
