<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Animalhotels ‚Äî Pet ‚Üî Sitter Match</title>
<style>
  :root{
    --bg:#0f1220;           /* deep night */
    --panel:#151931;        /* app card */
    --ink:#eaf0ff;          /* primary text */
    --muted:#9aa4c7;        /* secondary text */
    --brand:#6CE3D9;        /* Animalhotels vibe */
    --accent:#A7B1FF;       /* soft indigo */
    --warn:#FFC857;         /* timer */
    --bad:#FF6B6B;          /* wrong */
    --good:#6CE39C;         /* right */
    --shadow:0 8px 24px rgba(0,0,0,.35);
    --radius:16px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:radial-gradient(1200px 800px at 10% -10%, #1b2145 0%, #0f1220 55%), var(--bg);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, sans-serif;
    color:var(--ink);
    -webkit-tap-highlight-color: transparent;
    overflow:hidden;
  }
  header{
    display:flex; align-items:center; justify-content:space-between;
    padding:12px 16px 4px;
  }
  .brand{
    display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.3px;
  }
  .diamond{
    width:22px; height:22px; display:inline-block; position:relative;
    background: conic-gradient(from 45deg, var(--brand), var(--accent), var(--brand));
    transform: rotate(45deg); border-radius:4px; box-shadow: var(--shadow);
  }
  .hud{display:flex; gap:14px; align-items:center; font-size:14px; color:var(--muted)}
  .pill{
    padding:6px 10px; border-radius:999px; background:#0d1022; border:1px solid #20264a; color:var(--ink)
  }
  .pill em{font-style:normal; color:var(--brand); font-weight:700}
  main{
    display:grid; grid-template-columns: 1fr min(420px, 75vw) 1fr;
    grid-template-rows: auto 1fr auto; height:calc(100% - 58px); gap:10px; padding:8px 12px 16px;
  }
  /* Left: Pet queue + needs */
  .left{
    display:flex; flex-direction:column; gap:12px; padding:8px;
  }
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
    border:1px solid #242a52; border-radius:var(--radius); box-shadow: var(--shadow);
  }
  .pet-card{
    padding:14px; display:flex; gap:12px; align-items:center;
  }
  .pet-emoji{font-size:28px; filter: drop-shadow(0 3px 6px rgba(0,0,0,.35))}
  .tags{display:flex; flex-wrap:wrap; gap:6px; margin-top:6px}
  .tag{font-size:12px; padding:4px 8px; border-radius:999px; background:#101639; border:1px solid #29306b; color:#dfe6ff}
  .need{font-size:13px; color:var(--muted)}
  .queue{display:flex; gap:8px; overflow:auto; padding:6px 4px}
  .mini{min-width:54px; height:54px; display:flex; align-items:center; justify-content:center; border-radius:12px; border:1px dashed #2a3166; background:#0c1130; font-size:22px; opacity:.8}
  .mini.active{border-style:solid; opacity:1}

  /* Center: Phone drop zone */
  .phone{
    align-self:center; justify-self:center; width:min(420px, 75vw);
    height:min(720px, 82vh); border-radius:36px; padding:14px; background:linear-gradient(180deg,#0b0f22,#0a0d1d);
    border:2px solid #2a3166; box-shadow: 0 16px 60px rgba(0,0,0,.6), inset 0 0 0 6px #0b102a;
    position:relative; display:flex; flex-direction:column; gap:10px;
  }
  .notch{width:42%; height:20px; background:#060913; border-bottom-left-radius:14px; border-bottom-right-radius:14px; align-self:center}
  .app{
    flex:1; border-radius:20px; background: linear-gradient(180deg, #0f1632, #0a102b);
    border:1px solid #222a5a; position:relative; overflow:hidden; padding:10px;
  }
  .drop-zone{
    position:absolute; inset:10px; border-radius:16px; border:2px dashed #36408b; display:flex; align-items:center; justify-content:center;
    color:#b9c3ff; font-size:14px; text-align:center; padding:10px;
  }
  .drop-zone.ready{border-style:solid; color:#98ffd7; border-color:#2bdbbb}
  .flash{
    position:absolute; inset:0; border-radius:16px; pointer-events:none; opacity:0; transition:opacity .35s ease;
  }
  .flash.ok{background:rgba(108,227,156,.15)}
  .flash.bad{background:rgba(255,107,107,.15)}
  .flash.show{opacity:1}

  /* Right: Sitters (draggable) */
  .right{display:flex; flex-direction:column; gap:10px}
  .sitters{
    display:grid; grid-template-columns: 1fr; gap:10px; overflow:auto; padding-right:6px; max-height:70vh;
  }
  .sitter{
    padding:12px; display:flex; gap:10px; align-items:flex-start; cursor:grab; touch-action:none; position:relative;
  }
  .sitter:active{cursor:grabbing}
  .avatar{
    width:46px; height:46px; border-radius:12px; background:#0e153b; border:1px solid #2a3166; display:grid; place-items:center; font-size:22px
  }
  .sitter h4{margin:0; font-size:15px}
  .scoreline{font-size:12px; color:var(--muted)}
  .suit{display:flex; flex-wrap:wrap; gap:6px; margin-top:6px}
  .sitter.dragging {opacity:.9; transform:scale(1.02); z-index:9999}
  .floating{
    position:fixed; left:0; top:0; transform:translate(-9999px,-9999px); pointer-events:none;
  }

  /* Footer controls */
  .footer{
    grid-column:1/-1; display:flex; justify-content:center; gap:10px; padding-top:6px
  }
  button{
    appearance:none; border:none; padding:12px 16px; border-radius:14px; font-weight:700; letter-spacing:.3px;
    background:linear-gradient(180deg, #1e2861, #182158); color:#eaf0ff; border:1px solid #2a3474; box-shadow: var(--shadow);
  }
  button.secondary{background:linear-gradient(180deg, #152046, #111a3a)}
  button:active{transform:translateY(1px)}
  .timer{color:var(--warn); font-weight:700}
  .lives{letter-spacing:2px}

  /* Overlays */
  .overlay{
    position:fixed; inset:0; background:rgba(4,6,14,.75); display:none; align-items:center; justify-content:center; padding:16px; z-index:10000;
  }
  .overlay.show{display:flex}
  .modal{max-width:520px; width:100%; background:linear-gradient(180deg, #0f1634, #0a102a); border:1px solid #273070; border-radius:20px; padding:18px; box-shadow: var(--shadow)}
  .modal h2{margin:.2em 0 .4em 0}
  .options{display:flex; gap:8px; flex-wrap:wrap; margin:10px 0}
  .options button{flex:1}
  .leader{margin-top:8px; font-size:14px; color:var(--muted)}
  .leader ol{margin:.3em 0 .2em 1.2em}
  .sr{position:absolute; width:1px; height:1px; overflow:hidden; clip:rect(0 0 0 0)}
  @media (max-width:900px){
    main{grid-template-columns: 1fr}
    .left,.right{order:3}
    .phone{order:2}
    .sitters{grid-template-columns: 1fr 1fr}
  }
</style>
</head>
<body>
  <header>
    <div class="brand">
      <span class="diamond" aria-hidden="true"></span>
      <span>Animalhotels</span>
    </div>
    <div class="hud">
      <div class="pill">Level <em id="level">1</em></div>
      <div class="pill">XP <em id="score">0</em></div>
      <div class="pill">Time <em class="timer" id="time">20</em>s</div>
      <div class="pill">Lives <em class="lives" id="lives">‚ù§‚ù§‚ù§</em></div>
    </div>
  </header>

  <main>
    <section class="left">
      <article class="pet-card card" id="currentPet">
        <div class="pet-emoji" id="petEmoji" aria-hidden="true">üê∂</div>
        <div>
          <div id="petTitle" style="font-weight:700">Dog ‚Äî medium, active</div>
          <div class="need" id="petNeed">Needs: long walks</div>
          <div class="tags" id="petTags"></div>
        </div>
      </article>
      <div class="queue" id="queue"></div>
    </section>

    <section class="phone card" id="phone">
      <div class="notch" aria-hidden="true"></div>
      <div class="app">
        <div class="drop-zone" id="drop">Drag the best sitter here to confirm your match</div>
        <div class="flash" id="flash"></div>
      </div>
    </section>

    <section class="right">
      <div class="sitters" id="sitters"></div>
    </section>

    <div class="footer">
      <button id="startBtn">Start</button>
      <button id="howBtn" class="secondary">How to play</button>
    </div>
  </main>

  <!-- Overlays -->
  <div class="overlay" id="startOverlay" role="dialog" aria-modal="true" aria-labelledby="startTitle">
    <div class="modal">
      <h2 id="startTitle">Match pets to the right sitter</h2>
      <p style="color:var(--muted); margin-top:0">Choose difficulty and press Start. Drag the sitter card into the phone. Get it right to earn XP and level up.</p>
      <div class="options" role="group" aria-label="Difficulty">
        <button data-diff="easy">Easy</button>
        <button data-diff="normal">Normal</button>
        <button data-diff="hard">Hard</button>
      </div>
      <div class="options">
        <button id="startGame">Start Game</button>
      </div>
      <div class="leader">
        <strong>Top scores (this device)</strong>
        <ol id="board"></ol>
      </div>
    </div>
  </div>

  <div class="overlay" id="howOverlay" role="dialog" aria-modal="true" aria-labelledby="howTitle">
    <div class="modal">
      <h2 id="howTitle">How to play</h2>
      <ul style="margin:0 0 10px 18px; color:var(--muted); line-height:1.4">
        <li>Read the pet‚Äôs needs on the left.</li>
        <li>Drag the best sitter into the phone screen.</li>
        <li>Each correct match scores XP. Fill the progress to level up.</li>
        <li>Timer speeds up each level. Three hearts = three mistakes.</li>
        <li>Choose Easy / Normal / Hard to change spawn rate and complexity.</li>
      </ul>
      <div class="options">
        <button id="closeHow">Got it</button>
      </div>
    </div>
  </div>

  <div class="overlay" id="gameOver" role="dialog" aria-modal="true" aria-labelledby="overTitle">
    <div class="modal">
      <h2 id="overTitle">Game Over</h2>
      <p id="finalStats" style="margin-top:-6px; color:var(--muted)"></p>
      <div class="options">
        <input id="playerName" placeholder="Your name" aria-label="Your name"
               style="flex:2; padding:12px 14px; border-radius:12px; border:1px solid #2a3474; background:#0c1130; color:var(--ink)">
        <button id="saveScore">Save score</button>
        <button id="again">Play again</button>
      </div>
      <div class="leader">
        <strong>Top scores (this device)</strong>
        <ol id="board2"></ol>
      </div>
    </div>
  </div>

<script>
(()=> {
  // ---------- Data ----------
  const SPECIES = [
    {name:'Dog', emoji:'üê∂'},
    {name:'Cat', emoji:'üê±'},
    {name:'Rabbit', emoji:'üê∞'},
    {name:'Parrot', emoji:'ü¶ú'},
    {name:'Reptile', emoji:'ü¶é'}
  ];
  const SIZES = ['small','medium','large'];
  const TEMPER = ['calm','active','anxious'];
  const NEEDS = ['long walks','grooming','medication','playtime','experienced with anxious pets','house sitting','litter care','temperature control'];

  function rand(arr){ return arr[Math.floor(Math.random()*arr.length)] }
  function sample(arr, n){
    const a=[...arr], out=[];
    while(out.length<n && a.length){ out.push(a.splice(Math.floor(Math.random()*a.length),1)[0]) }
    return out;
  }
  function uid(){ return Math.random().toString(36).slice(2,9) }

  // ---------- State ----------
  const state = {
    difficulty:'normal',
    level:1,
    score:0,
    lives:3,
    timeLeft:20,
    running:false,
    currentPet:null,
    queue:[],
    sitters:[],
    levelGoal: 80, // XP to next level
    xpThisLevel: 0,
    timerId:null
  };

  // ---------- Difficulty tuning ----------
  const TUNE = {
    easy:   { baseTime:22, penalty:8, reward:20, options:3, decoys:1 },
    normal: { baseTime:18, penalty:10, reward:25, options:4, decoys:2 },
    hard:   { baseTime:14, penalty:12, reward:28, options:5, decoys:3 }
  };
  function timeForLevel(){
    const t = TUNE[state.difficulty].baseTime - Math.min(state.level-1, 8);
    return Math.max(8, t);
  }

  // ---------- Generators ----------
  function makePet(){
    const sp = rand(SPECIES);
    const size = rand(SIZES);
    const temper = rand(TEMPER);
    // choose a need coherent with species
    let pool = [...NEEDS];
    if(sp.name==='Dog') pool = ['long walks','grooming','medication','playtime','experienced with anxious pets','house sitting'];
    if(sp.name==='Cat') pool = ['litter care','grooming','medication','playtime','experienced with anxious pets','house sitting'];
    if(sp.name==='Rabbit') pool = ['grooming','medication','playtime','house sitting','experienced with anxious pets'];
    if(sp.name==='Parrot') pool = ['playtime','medication','house sitting','temperature control'];
    if(sp.name==='Reptile') pool = ['temperature control','medication','house sitting'];

    const need = rand(pool);
    return { id:uid(), species:sp.name, emoji:sp.emoji, size, temper, need };
  }

  function makeSitterPool(pet, count){
    // produce one optimal sitter and the rest decoys with varied suitability
    const names = ['Alex','Maja','Beata','Marcin','Weronika','Kuba','Ola','Tomek','Iga','Ania','Szymon','Basia','Karol','Nina'];
    const avatars = ['üßë‚Äçü¶∞','üßë‚Äçü¶±','üßë‚Äçü¶≥','üßî','üë©','üë®','üßë','üßë‚Äçü¶≤','üë©‚Äçü¶∞','üë®‚Äçü¶±','üë©‚Äçü¶≥','üë©‚Äçü¶≤'];
    const skillsBag = ['grooming','medication','long walks','playtime','litter care','temperature control','anxious pets','house sitting'];
    const pool=[];
    // guaranteed best match:
    const best = {
      id:uid(),
      name: rand(names),
      avatar: rand(avatars),
      species: [pet.species, rand(SPECIES).name],
      sizes: [pet.size, rand(SIZES)],
      temperFocus: [pet.temper],
      skills: [pet.need].concat(sample(skillsBag.filter(s=>s!==pet.need), 2)),
      rating: (4.7 + Math.random()*0.3).toFixed(2)
    };
    pool.push(best);
    // decoys:
    while(pool.length<count){
      const spSet = sample(SPECIES.map(s=>s.name), Math.random()<0.6?1:2);
      const szSet = sample(SIZES, Math.random()<0.6?1:2);
      const tempSet = sample(TEMPER, Math.random()<0.5?1:2);
      const dec = {
        id:uid(),
        name: rand(names),
        avatar: rand(avatars),
        species: spSet,
        sizes: szSet,
        temperFocus: tempSet,
        skills: sample(skillsBag, 3),
        rating: (4.2 + Math.random()*0.6).toFixed(2)
      };
      pool.push(dec);
    }
    // shuffle
    return pool.sort(()=>Math.random()-.5);
  }

  function compatScore(pet, sitter){
    let s=0;
    if(sitter.species.includes(pet.species)) s+=5;
    if(sitter.sizes.includes(pet.size)) s+=3;
    if(sitter.temperFocus.includes(pet.temper)) s+=3;
    // need mapping: "experienced with anxious pets" maps to "anxious pets"
    const needKey = pet.need==='experienced with anxious pets' ? 'anxious pets' : pet.need;
    if(sitter.skills.includes(needKey)) s+=6;
    return s;
  }

  function bestSitterId(pet, sitters){
    let top = -1, bestId=null;
    for(const st of sitters){
      const c = compatScore(pet, st);
      if(c>top){ top=c; bestId = st.id }
    }
    return bestId;
  }

  // ---------- Rendering ----------
  const $level = document.getElementById('level');
  const $score = document.getElementById('score');
  const $time  = document.getElementById('time');
  const $lives = document.getElementById('lives');
  const $queue = document.getElementById('queue');
  const $sitters = document.getElementById('sitters');
  const $drop = document.getElementById('drop');
  const $flash = document.getElementById('flash');

  function renderHUD(){
    $level.textContent = state.level;
    $score.textContent = state.score;
    $time.textContent = Math.ceil(state.timeLeft);
    $lives.textContent = '‚ù§'.repeat(state.lives) + '‚ô°'.repeat(Math.max(0,3-state.lives));
  }

  function renderPetCard(){
    const p = state.currentPet;
    document.getElementById('petEmoji').textContent = p.emoji;
    document.getElementById('petTitle').textContent = `${p.species} ‚Äî ${p.size}, ${p.temper}`;
    document.getElementById('petNeed').textContent = `Needs: ${p.need}`;
    const tags = document.getElementById('petTags');
    tags.innerHTML = '';
    [p.species, p.size, p.temper, p.need].forEach(t=>{
      const span = document.createElement('span'); span.className='tag'; span.textContent=t; tags.appendChild(span);
    });
  }
  function renderQueue(){
    $queue.innerHTML='';
    state.queue.forEach((p, i)=>{
      const d=document.createElement('div');
      d.className='mini'+(i===0?' active':'');
      d.textContent=p.emoji;
      $queue.appendChild(d);
    });
  }
  function tag(text){ const s=document.createElement('span'); s.className='tag'; s.textContent=text; return s; }

  function renderSitters(){
    $sitters.innerHTML='';
    state.sitters.forEach(st=>{
      const el = document.createElement('article');
      el.className='sitter card'; el.dataset.id=st.id; el.setAttribute('aria-grabbed','false'); el.setAttribute('role','button');
      el.innerHTML = `
        <div class="avatar" aria-hidden="true">${st.avatar}</div>
        <div>
          <h4>${st.name} ‚Ä¢ ‚≠ê ${st.rating}</h4>
          <div class="scoreline">Fit score shown after drop</div>
          <div class="suit"></div>
        </div>`;
      const suit = el.querySelector('.suit');
      [...st.species].slice(0,2).forEach(x=>suit.appendChild(tag(x)));
      [...st.sizes].slice(0,2).forEach(x=>suit.appendChild(tag(x)));
      suit.appendChild(tag(st.temperFocus[0]));
      suit.appendChild(tag(st.skills[0]));
      enableDrag(el);
      $sitters.appendChild(el);
    });
  }

  // ---------- Drag (pointer events for mobile) ----------
  let dragging=null, ghost=null;

  function enableDrag(el){
    el.addEventListener('pointerdown', e=>{
      if(!state.running) return;
      dragging = el;
      el.classList.add('dragging');
      el.setPointerCapture(e.pointerId);
      ghost = el.cloneNode(true);
      ghost.classList.add('floating');
      ghost.style.width = el.getBoundingClientRect().width+'px';
      document.body.appendChild(ghost);
      moveGhost(e.clientX, e.clientY);
      $drop.classList.add('ready');
    });
    el.addEventListener('pointermove', e=>{
      if(!dragging || e.buttons===0) return;
      moveGhost(e.clientX, e.clientY);
    });
    el.addEventListener('pointerup', e=>{
      if(!dragging) return;
      const hit = isOverDrop(e.clientX, e.clientY);
      finishDrag(dragging, hit);
      cleanupDrag(el);
    });
    el.addEventListener('pointercancel', ()=> cleanupDrag(el));
  }
  function moveGhost(x,y){
    const g = ghost;
    g.style.transform = `translate(${x - g.offsetWidth/2}px, ${y - g.offsetHeight/2}px)`;
  }
  function isOverDrop(x,y){
    const r = document.getElementById('phone').getBoundingClientRect();
    const inner = document.querySelector('.app').getBoundingClientRect();
    return x>inner.left && x<inner.right && y>inner.top && y<inner.bottom;
  }
  function cleanupDrag(el){
    if(ghost && ghost.parentNode) ghost.parentNode.removeChild(ghost);
    ghost=null;
    if(el){ el.classList.remove('dragging'); el.releasePointerCapture?.(event?.pointerId) }
    dragging=null;
    $drop.classList.remove('ready');
  }

  function finishDrag(el, dropped){
    const st = state.sitters.find(s=>s.id===el.dataset.id);
    const pet = state.currentPet;
    const fit = compatScore(pet, st);

    el.querySelector('.scoreline').textContent = `Fit score: ${fit}`;
    if(dropped){
      if(st.id === state.bestId){
        feedback(true);
        award(true);
      } else {
        feedback(false);
        award(false);
      }
      nextRound();
    }
  }

  // ---------- Game flow ----------
  function feedback(ok){
    $flash.className = 'flash ' + (ok?'ok':'bad') + ' show';
    setTimeout(()=> $flash.classList.remove('show'), 350);
  }
  function award(ok){
    if(ok){
      const gain = TUNE[state.difficulty].reward + (state.level-1)*2;
      state.score += gain;
      state.xpThisLevel += gain;
      if(state.xpThisLevel >= state.levelGoal){
        state.level++; state.xpThisLevel = 0;
      }
    } else {
      state.lives--;
      state.timeLeft = Math.max(4, state.timeLeft - 2);
      if(state.lives<=0){ return endGame() }
    }
    renderHUD();
  }

  function nextRound(){
    if(state.queue.length===0) refillQueue();
    state.currentPet = state.queue.shift();
    renderPetCard(); renderQueue();

    // build sitter options for this pet
    const opts = TUNE[state.difficulty].options + Math.min(state.level-1, TUNE[state.difficulty].decoys);
    state.sitters = makeSitterPool(state.currentPet, opts);
    state.bestId = bestSitterId(state.currentPet, state.sitters);
    renderSitters();

    // reset / refresh timer
    state.timeLeft = timeForLevel();
  }

  function refillQueue(){
    state.queue = Array.from({length:5}, ()=> makePet());
  }

  function tick(){
    if(!state.running) return;
    state.timeLeft -= 0.1;
    if(state.timeLeft<=0){
      state.timeLeft = 0;
      state.lives--;
      renderHUD();
      feedback(false);
      if(state.lives<=0) return endGame();
      nextRound();
    }
    renderHUD();
  }

  function startGame(){
    state.running=true;
    state.level=1; state.score=0; state.lives=3; state.xpThisLevel=0;
    refillQueue();
    nextRound();
    if(state.timerId) clearInterval(state.timerId);
    state.timerId = setInterval(tick, 100);
  }

  function endGame(){
    state.running=false;
    clearInterval(state.timerId);
    const stats = `You reached level ${state.level} with ${state.score} XP.`;
    document.getElementById('finalStats').textContent = stats;
    showBoard('board2');
    document.getElementById('gameOver').classList.add('show');
  }

  // ---------- Local leaderboard ----------
  function getBoard(){
    try{ return JSON.parse(localStorage.getItem('ah_board')||'[]') } catch(e){ return [] }
  }
  function saveBoard(list){ localStorage.setItem('ah_board', JSON.stringify(list.slice(0,10))) }
  function addScore(name, score){
    const list = getBoard();
    list.push({name:name||'Player', score, date: new Date().toISOString().slice(0,10)});
    list.sort((a,b)=> b.score - a.score);
    saveBoard(list);
  }
  function showBoard(elId){
    const list = getBoard();
    const el = document.getElementById(elId);
    el.innerHTML = list.length? '' : '<li>No scores yet</li>';
    list.slice(0,10).forEach(({name, score, date})=>{
      const li = document.createElement('li');
      li.textContent = `${name} ‚Äî ${score} XP (${date})`;
      el.appendChild(li);
    });
  }

  // ---------- UI wiring ----------
  const startOverlay = document.getElementById('startOverlay');
  const howOverlay = document.getElementById('howOverlay');

  document.getElementById('startBtn').addEventListener('click', ()=>{
    showBoard('board'); startOverlay.classList.add('show');
  });
  document.getElementById('howBtn').addEventListener('click', ()=> howOverlay.classList.add('show'));
  document.getElementById('closeHow').addEventListener('click', ()=> howOverlay.classList.remove('show'));

  document.getElementById('startGame').addEventListener('click', ()=>{
    startOverlay.classList.remove('show');
    startGame();
  });
  document.getElementById('again').addEventListener('click', ()=>{
    document.getElementById('gameOver').classList.remove('show');
    startGame();
  });
  document.getElementById('saveScore').addEventListener('click', ()=>{
    addScore(document.getElementById('playerName').value.trim(), state.score);
    showBoard('board2');
  });

  // Difficulty buttons
  startOverlay.querySelectorAll('[data-diff]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      startOverlay.querySelectorAll('[data-diff]').forEach(b=> b.classList.remove('active'));
      btn.classList.add('active');
      state.difficulty = btn.dataset.diff;
    });
  });

  // Keyboard quick restart (desktop)
  window.addEventListener('keydown', (e)=>{
    if(e.key===' ' && !state.running){ startGame() }
  });

  // Initial
  renderHUD(); renderQueue(); showBoard('board'); startOverlay.classList.add('show');
})();
</script>
</body>
</html>
